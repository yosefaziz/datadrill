id: python-window-functions
name: "PySpark Window Functions"
tagline: "Ranking, running totals & row comparisons in PySpark"
interviewer_says: "rank within groups, running total, compare to previous"
you_need: "Window, partitionBy, orderBy, row_number, lag"
description: "PySpark window functions mirror SQL but with a different API. Master the Window spec pattern for rankings and running calculations."
icon: "layers"
category: "Aggregation & Joins"
order: 4
prerequisites: [python-groupby-agg]

levels:
  - level: 1
    title: "ROW_NUMBER"
    description: "Assign row numbers within partitions"
    concepts: ["Window", "partitionBy", "orderBy", "row_number"]
    questions:
      - py-window-row-number
    unlock: always_unlocked

  - level: 2
    title: "Ranking Functions"
    description: "Use rank and dense_rank for ties"
    concepts: ["rank", "dense_rank", "tie handling"]
    questions:
      - py-window-rank
    unlock: complete_previous

  - level: 3
    title: "Running Totals"
    description: "Compute cumulative sums and averages"
    concepts: ["sum over window", "rowsBetween", "unboundedPreceding"]
    questions:
      - py-window-cumsum
      - py-window-cumavg
    unlock: complete_previous

  - level: 4
    title: "LAG & LEAD"
    description: "Compare current row to previous or next"
    concepts: ["lag", "lead", "offset", "default value"]
    questions:
      - py-window-lag
    unlock: complete_previous
