id: python-reshaping
name: "Reshaping Data"
tagline: "Pivot, unpivot, explode arrays & flatten nested JSON"
interviewer_says: "pivot monthly sales, explode the array, flatten nested JSON"
you_need: "pivot(), stack(), explode(), getField(), from_json()"
description: "Reshape PySpark DataFrames between wide and long formats, and flatten nested structures from arrays, structs, and JSON."
icon: "table"
category: "PySpark"
order: 5
prerequisites: [python-dataframe-basics]

levels:
  - level: 1
    title: "Basic Pivot"
    description: "Pivot rows to columns with aggregation"
    concepts: ["groupBy", "pivot", "sum"]
    questions:
      - py-pivot-basic
    unlock: always_unlocked

  - level: 2
    title: "Multi-Value Pivot"
    description: "Pivot with multiple aggregate functions"
    concepts: ["pivot", "agg", "multiple values"]
    questions:
      - py-pivot-multi-agg
      - py-pivot-explicit-values
    unlock: complete_previous

  - level: 3
    title: "Unpivot"
    description: "Transform wide format to long format"
    concepts: ["stack", "unpivot", "selectExpr"]
    questions:
      - py-unpivot-stack
    unlock: complete_previous

  - level: 4
    title: "Explode Arrays"
    description: "Explode an array column into rows"
    concepts: ["explode", "explode_outer", "arrays"]
    questions:
      - py-explode-array
    unlock: complete_previous

  - level: 5
    title: "Access Structs"
    description: "Navigate and extract nested struct fields"
    concepts: ["getField", "dot notation", "struct"]
    questions:
      - py-nested-struct
      - py-nested-map-access
    unlock: complete_previous

  - level: 6
    title: "Flatten JSON"
    description: "Parse and flatten deeply nested JSON"
    concepts: ["from_json", "schema_of_json", "flatten"]
    questions:
      - py-nested-json-flatten
    unlock: complete_previous
